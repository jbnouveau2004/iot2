<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPIO Raspberry</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>LED GPIO 27</h2>
<button onclick="setLed(1)">Allumer</button>
<button onclick="setLed(0)">Éteindre</button>

<h2>Bouton GPIO 4</h2>
<p>État : <span id="btn">?</span></p>

<script>
const API = "http://192.168.1.109:3000";
const TOKEN = "2755";

function setLed(value) {
  fetch(API + "/led", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + TOKEN
    },
    body: JSON.stringify({ value })
  });
}

function readButton() {
  fetch(API + "/button", {
    headers: {
      "Authorization": "Bearer " + TOKEN
    }
  })
  .then(r => r.json())
  .then(d => {
    document.getElementById("btn").textContent =
      d.value ? "APPUYÉ" : "RELÂCHÉ";
  });
}

setInterval(readButton, 500);
</script>

</body>
</html>